<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BlockNest | Enterprise Blockchain Analytics</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'] },
                    colors: {
                        dark: {
                            50: '#f8fafc',
                            100: '#f1f5f9',
                            200: '#e2e8f0',
                            300: '#cbd5e1',
                            400: '#94a3b8',
                            500: '#64748b',
                            600: '#475569',
                            700: '#334155',
                            800: '#1e293b',
                            900: '#0f172a',
                            950: '#020617',
                        },
                        accent: {
                            blue: '#3b82f6',
                            green: '#10b981',
                            purple: '#8b5cf6',
                            orange: '#f59e0b',
                            red: '#ef4444'
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body { background-color: #020617; color: #f1f5f9; }
        .sidebar-link.active {
            background: linear-gradient(90deg, rgba(59, 130, 246, 0.15) 0%, rgba(59, 130, 246, 0) 100%);
            border-right: 3px solid #3b82f6;
            color: #3b82f6;
        }
        .glass-card {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.03);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        }
        .glass-card:hover {
            border-color: rgba(59, 130, 246, 0.2);
            background: rgba(15, 23, 42, 0.8);
        }
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #1e293b; border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #334155; }
        
        @keyframes pulse-soft {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(0.98); }
        }
        .animate-pulse-soft { animation: pulse-soft 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        
        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        .shimmer {
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.03), transparent);
            background-size: 200% 100%;
            animation: shimmer 3s infinite linear;
        }

        .section-transition {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
        }
        
        .table-row-hover:hover {
            background-color: rgba(59, 130, 246, 0.03);
        }
    </style>
</head>
<body class="font-sans antialiased text-slate-300">
    <div class="flex h-screen overflow-hidden bg-dark-950">
        <!-- Sidebar -->
        <aside class="w-72 bg-dark-900 border-r border-slate-800 flex flex-col z-20">
            <div class="p-8 flex items-center space-x-4">
                <div class="w-10 h-10 bg-accent-blue rounded-xl flex items-center justify-center shadow-lg shadow-blue-500/20">
                    <i class="fas fa-layer-group text-white text-xl"></i>
                </div>
                <div>
                    <span class="text-xl font-bold text-white tracking-tight">BlockNest</span>
                    <p class="text-[10px] text-slate-500 uppercase tracking-widest font-semibold">Enterprise Suite</p>
                </div>
            </div>
            
            <nav class="flex-1 px-4 py-4 space-y-2 custom-scrollbar overflow-y-auto">
                <p class="px-4 text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-2">Main Menu</p>
                <a href="#" onclick="showSection('dashboard')" id="nav-dashboard" class="sidebar-link active flex items-center px-4 py-3 rounded-xl transition-all duration-200 group">
                    <i class="fas fa-th-large mr-4 text-lg transition-transform group-hover:scale-110"></i> 
                    <span class="font-medium">Analytics Overview</span>
                </a>
                <a href="#" onclick="showSection('transactions')" id="nav-transactions" class="sidebar-link flex items-center px-4 py-3 text-slate-400 hover:text-white hover:bg-slate-800/50 rounded-xl transition-all duration-200 group">
                    <i class="fas fa-exchange-alt mr-4 text-lg transition-transform group-hover:scale-110"></i> 
                    <span class="font-medium">Transaction Ledger</span>
                </a>
                <a href="#" onclick="showSection('wallets')" id="nav-wallets" class="sidebar-link flex items-center px-4 py-3 text-slate-400 hover:text-white hover:bg-slate-800/50 rounded-xl transition-all duration-200 group">
                    <i class="fas fa-wallet mr-4 text-lg transition-transform group-hover:scale-110"></i> 
                    <span class="font-medium">Wallet Inventory</span>
                </a>
                <a href="#" onclick="showSection('revenues')" id="nav-revenues" class="sidebar-link flex items-center px-4 py-3 text-slate-400 hover:text-white hover:bg-slate-800/50 rounded-xl transition-all duration-200 group">
                    <i class="fas fa-chart-line mr-4 text-lg transition-transform group-hover:scale-110"></i> 
                    <span class="font-medium">Revenue Analysis</span>
                </a>
                
                <p class="px-4 text-[10px] font-bold text-slate-500 uppercase tracking-widest mt-8 mb-2">Infrastructure</p>
                <a href="#" onclick="showSection('status')" id="nav-status" class="sidebar-link flex items-center px-4 py-3 text-slate-400 hover:text-white hover:bg-slate-800/50 rounded-xl transition-all duration-200 group">
                    <i class="fas fa-heartbeat mr-4 text-lg transition-transform group-hover:scale-110"></i> 
                    <span class="font-medium">System Status</span>
                </a>
                <a href="#" onclick="showSection('blockchains')" id="nav-blockchains" class="sidebar-link flex items-center px-4 py-3 text-slate-400 hover:text-white hover:bg-slate-800/50 rounded-xl transition-all duration-200 group">
                    <i class="fas fa-network-wired mr-4 text-lg transition-transform group-hover:scale-110"></i> 
                    <span class="font-medium">Node Network</span>
                </a>
                <a href="#" onclick="showSection('settings')" id="nav-settings" class="sidebar-link flex items-center px-4 py-3 text-slate-400 hover:text-white hover:bg-slate-800/50 rounded-xl transition-all duration-200 group">
                    <i class="fas fa-sliders-h mr-4 text-lg transition-transform group-hover:scale-110"></i> 
                    <span class="font-medium">System Configuration</span>
                </a>
            </nav>

            <div class="p-6 border-t border-slate-800">
                <div class="glass-card p-4 rounded-2xl flex items-center space-x-3">
                    <div class="relative">
                        <img src="https://ui-avatars.com/api/?name=Admin&background=3b82f6&color=fff" class="w-10 h-10 rounded-xl border border-slate-700" alt="Avatar">
                        <span class="absolute -bottom-1 -right-1 w-3 h-3 bg-accent-green border-2 border-dark-900 rounded-full animate-pulse-soft"></span>
                    </div>
                    <div class="overflow-hidden">
                        <p class="text-sm font-bold text-white truncate">System Administrator</p>
                        <p class="text-[10px] text-slate-500 font-semibold">Live Mode</p>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <div class="flex-1 flex flex-col min-w-0 bg-dark-950/50">
            <!-- Header -->
            <header class="h-20 bg-dark-950/80 border-b border-white/5 flex items-center justify-between px-10 backdrop-blur-xl z-10 sticky top-0">
                <div class="flex items-center space-x-6">
                    <div class="flex flex-col">
                        <h1 id="section-title" class="text-xl font-bold text-white tracking-tight">Analytics Overview</h1>
                        <p id="section-subtitle" class="text-[10px] text-slate-500 font-bold uppercase tracking-[0.2em]">Real-time Network Intelligence</p>
                    </div>
                    <div class="h-8 w-px bg-white/5 mx-2"></div>
                    <div id="live-indicator" class="flex items-center space-x-2.5 px-3 py-1.5 bg-accent-green/10 rounded-full border border-accent-green/20">
                        <span class="w-1.5 h-1.5 bg-accent-green rounded-full animate-pulse shadow-[0_0_8px_rgba(16,185,129,0.4)]"></span>
                        <span class="text-[9px] font-bold uppercase tracking-widest text-accent-green">Live Engine</span>
                    </div>
                </div>
                
                <div class="flex items-center space-x-6">
                    <!-- Global User Filter -->
                    <div class="flex items-center bg-slate-900/50 p-1 rounded-2xl border border-white/5 hover:border-white/10 transition-all">
                        <div class="flex items-center px-3 py-1.5 space-x-3">
                            <i class="fas fa-user-shield text-slate-500 text-sm"></i>
                            <select id="global-user-filter" onchange="handleUserFilterChange()" class="bg-transparent text-xs font-bold text-slate-300 focus:outline-none pr-4 cursor-pointer">
                                <option value="" class="bg-dark-900">Global View</option>
                            </select>
                        </div>
                    </div>

                    <div class="h-8 w-px bg-white/5 mx-2"></div>

                    <div class="flex items-center space-x-3">
                        <button class="w-10 h-10 flex items-center justify-center rounded-xl bg-slate-900/50 border border-white/5 text-slate-400 hover:text-white hover:border-white/10 transition-all relative group">
                            <i class="far fa-bell text-lg"></i>
                            <span class="absolute top-2.5 right-2.5 w-2 h-2 bg-accent-red rounded-full border-2 border-dark-950"></span>
                            <div class="absolute top-12 right-0 w-64 bg-dark-900 border border-white/5 rounded-2xl p-4 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all shadow-2xl z-50">
                                <p class="text-xs font-bold text-white mb-2">Notifications</p>
                                <p class="text-[10px] text-slate-500">No new alerts at this time.</p>
                            </div>
                        </button>
                        
                        <button onclick="toggleTheme()" class="w-10 h-10 flex items-center justify-center rounded-xl bg-slate-900/50 border border-white/5 text-slate-400 hover:text-white hover:border-white/10 transition-all">
                            <i class="fas fa-moon text-lg"></i>
                        </button>
                    </div>
                </div>
            </header>

            <!-- Scrollable Content -->
            <div class="flex-1 overflow-y-auto custom-scrollbar p-10 space-y-10">
                
                <!-- Dashboard Content -->
                <div id="dashboard-section" class="section space-y-10">
                    <div class="flex flex-col md:flex-row md:items-center justify-between gap-6">
                        <div>
                            <h2 class="text-4xl font-extrabold text-white tracking-tight">Analytics Overview</h2>
                            <p class="text-[10px] font-bold text-slate-500 uppercase tracking-[0.2em] mt-2">Real-time Network Intelligence & Financial Performance</p>
                        </div>
                        <div class="flex items-center space-x-3 bg-slate-900/50 p-1.5 rounded-2xl border border-white/5">
                            <button class="px-5 py-2.5 bg-accent-blue text-white rounded-xl font-bold text-[11px] uppercase tracking-wider shadow-lg shadow-blue-500/20 transition-all">Real-time</button>
                            <button class="px-5 py-2.5 text-slate-400 hover:text-white rounded-xl font-bold text-[11px] uppercase tracking-wider transition-all">Historical</button>
                        </div>
                    </div>

                    <!-- Metrics Grid -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-6">
                        <div class="glass-card p-6 rounded-3xl relative overflow-hidden group transition-all duration-500 hover:-translate-y-1 border border-white/5">
                            <div class="absolute -right-6 -bottom-6 opacity-[0.03] group-hover:opacity-[0.08] transition-all duration-500 group-hover:scale-110">
                                <i class="fas fa-exchange-alt text-8xl"></i>
                            </div>
                            <div class="flex items-center justify-between mb-6">
                                <div class="w-12 h-12 rounded-2xl bg-blue-500/10 flex items-center justify-center text-accent-blue shadow-inner">
                                    <i class="fas fa-exchange-alt text-xl"></i>
                                </div>
                                <div class="px-2 py-1 rounded-lg bg-accent-green/10 text-[8px] font-bold text-accent-green uppercase tracking-tighter border border-accent-green/20">
                                    +12.5%
                                </div>
                            </div>
                            <p class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-1">Total Volume</p>
                            <h3 id="total-transactions" class="text-2xl font-bold text-white tracking-tight">0</h3>
                        </div>

                        <div class="glass-card p-6 rounded-3xl relative overflow-hidden group transition-all duration-500 hover:-translate-y-1 border border-white/5">
                            <div class="absolute -right-6 -bottom-6 opacity-[0.03] group-hover:opacity-[0.08] transition-all duration-500 group-hover:scale-110">
                                <i class="fas fa-clock text-8xl"></i>
                            </div>
                            <div class="flex items-center justify-between mb-6">
                                <div class="w-12 h-12 rounded-2xl bg-orange-500/10 flex items-center justify-center text-accent-orange shadow-inner">
                                    <i class="fas fa-clock text-xl"></i>
                                </div>
                                <div class="px-2 py-1 rounded-lg bg-slate-800 text-[8px] font-bold text-slate-400 uppercase tracking-tighter">
                                    Live
                                </div>
                            </div>
                            <p class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-1">Pending Tasks</p>
                            <h3 id="pending-withdrawals" class="text-2xl font-bold text-white tracking-tight">0</h3>
                        </div>

                        <div class="glass-card p-6 rounded-3xl relative overflow-hidden group transition-all duration-500 hover:-translate-y-1 border border-white/5">
                            <div class="absolute -right-6 -bottom-6 opacity-[0.03] group-hover:opacity-[0.08] transition-all duration-500 group-hover:scale-110">
                                <i class="fas fa-wallet text-8xl"></i>
                            </div>
                            <div class="flex items-center justify-between mb-6">
                                <div class="w-12 h-12 rounded-2xl bg-green-500/10 flex items-center justify-center text-accent-green shadow-inner">
                                    <i class="fas fa-wallet text-xl"></i>
                                </div>
                                <div class="px-2 py-1 rounded-lg bg-accent-green/10 text-[8px] font-bold text-accent-green uppercase tracking-tighter border border-accent-green/20">
                                    +8.2%
                                </div>
                            </div>
                            <p class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-1">Total Revenue</p>
                            <h3 id="total-revenue" class="text-2xl font-bold text-white tracking-tight">$0.00</h3>
                        </div>

                        <div class="glass-card p-6 rounded-3xl relative overflow-hidden group transition-all duration-500 hover:-translate-y-1 border border-white/5">
                            <div class="absolute -right-6 -bottom-6 opacity-[0.03] group-hover:opacity-[0.08] transition-all duration-500 group-hover:scale-110">
                                <i class="fas fa-users text-8xl"></i>
                            </div>
                            <div class="flex items-center justify-between mb-6">
                                <div class="w-12 h-12 rounded-2xl bg-blue-500/10 flex items-center justify-center text-accent-blue shadow-inner">
                                    <i class="fas fa-users text-xl"></i>
                                </div>
                            </div>
                            <p class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-1">User Balance</p>
                            <h3 id="total-user-balance" class="text-2xl font-bold text-white tracking-tight">$0.00</h3>
                        </div>

                        <div class="glass-card p-6 rounded-3xl relative overflow-hidden group transition-all duration-500 hover:-translate-y-1 border border-white/5">
                            <div class="absolute -right-6 -bottom-6 opacity-[0.03] group-hover:opacity-[0.08] transition-all duration-500 group-hover:scale-110">
                                <i class="fas fa-network-wired text-8xl"></i>
                            </div>
                            <div class="flex items-center justify-between mb-6">
                                <div class="w-12 h-12 rounded-2xl bg-purple-500/10 flex items-center justify-center text-accent-purple shadow-inner">
                                    <i class="fas fa-network-wired text-xl"></i>
                                </div>
                            </div>
                            <p class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-1">Net Balance</p>
                            <h3 id="total-network-balance" class="text-2xl font-bold text-white tracking-tight">$0.00</h3>
                        </div>

                        <div class="glass-card p-6 rounded-3xl relative overflow-hidden group transition-all duration-500 hover:-translate-y-1 border border-white/5">
                            <div class="absolute -right-6 -bottom-6 opacity-[0.03] group-hover:opacity-[0.08] transition-all duration-500 group-hover:scale-110">
                                <i class="fas fa-server text-8xl"></i>
                            </div>
                            <div class="flex items-center justify-between mb-6">
                                <div class="w-12 h-12 rounded-2xl bg-purple-500/10 flex items-center justify-center text-accent-purple shadow-inner">
                                    <i class="fas fa-server text-xl"></i>
                                </div>
                                <div class="flex items-center space-x-1">
                                    <span class="w-1.5 h-1.5 bg-accent-green rounded-full animate-pulse"></span>
                                    <span class="text-[8px] font-bold text-accent-green uppercase">Stable</span>
                                </div>
                            </div>
                            <p class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-1">Live Nodes</p>
                            <h3 id="active-blockchains" class="text-2xl font-bold text-white tracking-tight">0</h3>
                        </div>
                    </div>

                    <!-- Visual Data Row -->
                    <div class="grid grid-cols-1 lg:grid-cols-12 gap-10">
                        <div class="lg:col-span-8 glass-card p-8 rounded-[2.5rem] flex flex-col border border-white/5">
                            <div class="flex items-center justify-between mb-10">
                                <div>
                                    <h2 class="text-xl font-bold text-white tracking-tight">Performance Matrix</h2>
                                    <p class="text-[10px] font-bold text-slate-500 uppercase tracking-[0.2em] mt-2">System-wide revenue and transaction metrics</p>
                                </div>
                                <div class="flex items-center space-x-2 bg-slate-900/50 p-1 rounded-xl border border-white/5">
                                    <button class="px-4 py-2 bg-slate-800 text-[10px] font-bold text-white rounded-lg transition-colors uppercase tracking-widest">Daily</button>
                                    <button class="px-4 py-2 text-[10px] font-bold text-slate-500 hover:text-slate-300 transition-colors uppercase tracking-widest">Weekly</button>
                                </div>
                            </div>
                            <div class="flex-1 min-h-[400px]">
                                <canvas id="revenueChart"></canvas>
                            </div>
                        </div>

                        <div class="lg:col-span-4 glass-card p-8 rounded-[2.5rem] border border-white/5 bg-slate-900/50">
                            <div class="flex items-center justify-between mb-8">
                                <h2 class="text-xl font-bold text-white tracking-tight">Network Pulse</h2>
                                <span class="px-3 py-1 bg-accent-blue/10 text-accent-blue text-[8px] font-bold uppercase tracking-widest rounded-full border border-accent-blue/20">Active Nodes</span>
                            </div>
                            <div id="blockchain-list" class="space-y-6">
                                <!-- Blockchains -->
                            </div>
                            <button onclick="showSection('blockchains')" class="w-full mt-10 py-4 bg-slate-800/50 hover:bg-slate-800 text-[10px] font-bold text-white rounded-2xl transition-all border border-white/5 hover:border-white/10 uppercase tracking-[0.2em]">
                                Infrastructure Console
                            </button>
                        </div>
                    </div>

                    <!-- Latest Activity -->
                    <div class="glass-card p-8 rounded-[2.5rem] border border-white/5">
                        <div class="flex items-center justify-between mb-10">
                            <div>
                                <h2 class="text-xl font-bold text-white tracking-tight">Real-time Stream</h2>
                                <p class="text-[10px] font-bold text-slate-500 uppercase tracking-[0.2em] mt-2">Latest cross-chain operations and status</p>
                            </div>
                            <button onclick="showSection('transactions')" class="px-5 py-2.5 bg-slate-800/50 hover:bg-slate-800 text-[10px] font-bold text-accent-blue rounded-xl border border-white/5 transition-all flex items-center space-x-2 uppercase tracking-widest">
                                <span>Full Ledger</span>
                                <i class="fas fa-arrow-right text-[8px]"></i>
                            </button>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left border-separate border-spacing-y-0">
                                <thead>
                                    <tr class="bg-slate-900/50 text-slate-400 text-[10px] font-bold uppercase tracking-widest border-b border-white/5">
                                        <th class="px-8 py-6">Identification</th>
                                        <th class="px-8 py-6">Protocol</th>
                                        <th class="px-8 py-6">Operation</th>
                                        <th class="px-8 py-6">Asset Value</th>
                                        <th class="px-8 py-6 text-center">Verification</th>
                                        <th class="px-8 py-6 text-right">Timestamp</th>
                                    </tr>
                                </thead>
                                <tbody id="transactions-table-recent" class="divide-y divide-white/5">
                                    <!-- Rows -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Wallets Section -->
                <div id="wallets-section" class="section hidden space-y-10">
                    <div class="flex flex-col md:flex-row md:items-center justify-between gap-6">
                        <div>
                            <h2 class="text-4xl font-extrabold text-white tracking-tight">Asset Inventory</h2>
                            <p class="text-[10px] font-bold text-slate-500 uppercase tracking-[0.2em] mt-2">Institutional-grade wallet monitoring & security</p>
                        </div>
                        <div class="flex flex-wrap items-center gap-3">
                            <div class="relative group">
                                <i class="fas fa-search absolute left-4 top-1/2 -translate-y-1/2 text-slate-500 group-focus-within:text-accent-blue transition-colors"></i>
                                <input type="text" placeholder="Search by address..." class="pl-12 pr-6 py-3.5 bg-slate-900/50 border border-white/5 rounded-2xl text-[11px] font-bold uppercase tracking-widest focus:outline-none focus:border-accent-blue/50 w-80 text-white transition-all focus:bg-slate-900 shadow-inner">
                            </div>
                            <button class="px-6 py-3.5 bg-accent-blue text-white rounded-2xl font-bold text-[11px] uppercase tracking-widest hover:bg-blue-600 shadow-lg shadow-blue-500/20 transition-all active:scale-95 flex items-center">
                                <i class="fas fa-plus mr-2 text-[10px]"></i> Register Vault
                            </button>
                        </div>
                    </div>

                    <!-- Wallets Metrics -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div class="glass-card p-8 rounded-[2.5rem] border border-white/5 relative overflow-hidden group">
                            <div class="absolute -right-4 -bottom-4 opacity-[0.03] group-hover:opacity-[0.08] transition-all duration-500">
                                <i class="fas fa-wallet text-7xl"></i>
                            </div>
                            <p class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-2">Total Vaults</p>
                            <h3 id="wallet-count-summary" class="text-3xl font-bold text-white tracking-tight">0</h3>
                        </div>
                        <div class="glass-card p-8 rounded-[2.5rem] border border-white/5 relative overflow-hidden group">
                            <div class="absolute -right-4 -bottom-4 opacity-[0.03] group-hover:opacity-[0.08] transition-all duration-500">
                                <i class="fas fa-coins text-7xl"></i>
                            </div>
                            <p class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-2">Active Assets</p>
                            <h3 id="wallet-assets-summary" class="text-3xl font-bold text-white tracking-tight">0</h3>
                        </div>
                        <div class="glass-card p-8 rounded-[2.5rem] border border-white/5 relative overflow-hidden group">
                            <div class="absolute -right-4 -bottom-4 opacity-[0.03] group-hover:opacity-[0.08] transition-all duration-500">
                                <i class="fas fa-dollar-sign text-7xl"></i>
                            </div>
                            <p class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-2">Aggregated Balance</p>
                            <h3 id="wallet-balance-summary" class="text-3xl font-bold text-white tracking-tight">$0.00</h3>
                        </div>
                        <div class="glass-card p-8 rounded-[2.5rem] border border-white/5 relative overflow-hidden group">
                            <div class="absolute -right-4 -bottom-4 opacity-[0.03] group-hover:opacity-[0.08] transition-all duration-500">
                                <i class="fas fa-shield-alt text-7xl"></i>
                            </div>
                            <p class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-2">Security Health</p>
                            <h3 class="text-3xl font-bold text-accent-green tracking-tight">Optimal</h3>
                        </div>
                    </div>
                    
                    <div class="glass-card rounded-[2.5rem] overflow-hidden border border-white/5 bg-slate-900/30">
                        <div class="overflow-x-auto">
                            <table class="w-full text-left border-separate border-spacing-y-0">
                                <thead>
                                    <tr class="bg-slate-900/50 text-slate-400 text-[10px] font-bold uppercase tracking-widest border-b border-white/5">
                                        <th class="px-8 py-6">Vault Address</th>
                                        <th class="px-8 py-6">Account Holder</th>
                                        <th class="px-8 py-6">Protocol</th>
                                        <th class="px-8 py-6">Allocated Balances</th>
                                        <th class="px-8 py-6">Operational Status</th>
                                        <th class="px-8 py-6 text-right">Provisioned On</th>
                                    </tr>
                                </thead>
                                <tbody id="wallets-table" class="divide-y divide-white/5">
                                    <!-- Wallets -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Transactions Section -->
                <div id="transactions-section" class="section hidden space-y-10">
                    <div class="flex flex-col md:flex-row md:items-center justify-between gap-6">
                        <div>
                            <h2 class="text-4xl font-extrabold text-white tracking-tight">Financial Ledger</h2>
                            <p class="text-[10px] font-bold text-slate-500 uppercase tracking-[0.2em] mt-2">Immutable cross-chain operational record</p>
                        </div>
                        <div class="flex flex-wrap items-center gap-3">
                            <select class="px-6 py-3.5 bg-slate-900/50 border border-white/5 rounded-2xl text-[11px] font-bold uppercase tracking-widest focus:outline-none focus:border-accent-blue text-slate-300 transition-all focus:bg-slate-900 shadow-inner">
                                <option>All Protocols</option>
                                <option>Bitcoin</option>
                                <option>Ethereum</option>
                                <option>Tron</option>
                            </select>
                            <button class="px-6 py-3.5 bg-slate-800/50 border border-white/5 text-white rounded-2xl font-bold text-[11px] uppercase tracking-widest hover:bg-slate-800 transition-all active:scale-95 flex items-center">
                                <i class="fas fa-download mr-2 text-slate-400 text-[10px]"></i> Export Ledger
                            </button>
                        </div>
                    </div>

                    <!-- Transactions Metrics -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div class="glass-card p-8 rounded-[2.5rem] border border-white/5 relative overflow-hidden group">
                            <div class="absolute -right-4 -bottom-4 opacity-[0.03] group-hover:opacity-[0.08] transition-all duration-500">
                                <i class="fas fa-list-ul text-7xl"></i>
                            </div>
                            <p class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-2">Total Operations</p>
                            <h3 id="tx-total-summary" class="text-3xl font-bold text-white tracking-tight">0</h3>
                        </div>
                        <div class="glass-card p-8 rounded-[2.5rem] border border-white/5 relative overflow-hidden group">
                            <div class="absolute -right-4 -bottom-4 opacity-[0.03] group-hover:opacity-[0.08] transition-all duration-500">
                                <i class="fas fa-check-circle text-7xl"></i>
                            </div>
                            <p class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-2">Success Rate</p>
                            <h3 id="tx-success-summary" class="text-3xl font-bold text-accent-green tracking-tight">100%</h3>
                        </div>
                        <div class="glass-card p-8 rounded-[2.5rem] border border-white/5 relative overflow-hidden group">
                            <div class="absolute -right-4 -bottom-4 opacity-[0.03] group-hover:opacity-[0.08] transition-all duration-500">
                                <i class="fas fa-chart-line text-7xl"></i>
                            </div>
                            <p class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-2">Cumulative Volume</p>
                            <h3 id="tx-volume-summary" class="text-3xl font-bold text-white tracking-tight">$0.00</h3>
                        </div>
                        <div class="glass-card p-8 rounded-[2.5rem] border border-white/5 relative overflow-hidden group">
                            <div class="absolute -right-4 -bottom-4 opacity-[0.03] group-hover:opacity-[0.08] transition-all duration-500">
                                <i class="fas fa-clock text-7xl"></i>
                            </div>
                            <p class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-2">Pending Queue</p>
                            <h3 id="tx-pending-summary" class="text-3xl font-bold text-accent-orange tracking-tight">0</h3>
                        </div>
                    </div>
                    
                    <div class="glass-card rounded-[2.5rem] overflow-hidden border border-white/5 bg-slate-900/30">
                        <div class="overflow-x-auto">
                            <table class="w-full text-left border-separate border-spacing-y-0">
                                <thead>
                                    <tr class="bg-slate-900/50 text-slate-400 text-[10px] font-bold uppercase tracking-widest border-b border-white/5">
                                        <th class="px-8 py-6">TX Identification</th>
                                        <th class="px-8 py-6">Network</th>
                                        <th class="px-8 py-6">Type</th>
                                        <th class="px-8 py-6">Value</th>
                                        <th class="px-8 py-6">Verification</th>
                                        <th class="px-8 py-6 text-right">Date Executed</th>
                                    </tr>
                                </thead>
                                <tbody id="transactions-table-full" class="divide-y divide-white/5">
                                    <!-- Transactions -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Revenues Section -->
                <div id="revenues-section" class="section hidden space-y-10">
                    <div class="flex flex-col md:flex-row md:items-center justify-between gap-6">
                        <div>
                            <h2 class="text-4xl font-extrabold text-white tracking-tight">Revenue Analysis</h2>
                            <p class="text-[10px] font-bold text-slate-500 uppercase tracking-[0.2em] mt-2">Institutional Yield Performance & Asset Management</p>
                        </div>
                        <div class="flex items-center space-x-3 bg-slate-900/50 p-1.5 rounded-2xl border border-white/5">
                            <button class="px-5 py-2.5 bg-accent-blue text-white rounded-xl font-bold text-[11px] uppercase tracking-wider shadow-lg shadow-blue-500/20 transition-all">Consolidated</button>
                            <button class="px-5 py-2.5 text-slate-400 hover:text-white rounded-xl font-bold text-[11px] uppercase tracking-wider transition-all">Protocol Split</button>
                        </div>
                    </div>

                    <!-- Revenue Summary Cards -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                        <div class="glass-card p-6 rounded-3xl border border-white/5 bg-slate-900/50 relative overflow-hidden group">
                            <div class="absolute -right-4 -bottom-4 opacity-[0.03] group-hover:opacity-[0.08] transition-all duration-500 group-hover:scale-110">
                                <i class="fas fa-coins text-6xl"></i>
                            </div>
                            <p class="text-[9px] font-bold text-slate-500 uppercase tracking-widest mb-1">Net Asset Yield</p>
                            <h3 id="revenue-total-summary" class="text-2xl font-bold text-white tracking-tight">$0.00</h3>
                            <div class="mt-4 flex items-center text-[8px] font-bold text-accent-green uppercase tracking-tighter">
                                <i class="fas fa-arrow-up mr-1"></i> 14.2% Growth
                            </div>
                        </div>
                        <div class="glass-card p-6 rounded-3xl border border-white/5 bg-slate-900/50 relative overflow-hidden group">
                            <div class="absolute -right-4 -bottom-4 opacity-[0.03] group-hover:opacity-[0.08] transition-all duration-500 group-hover:scale-110">
                                <i class="fas fa-gas-pump text-6xl"></i>
                            </div>
                            <p class="text-[9px] font-bold text-slate-500 uppercase tracking-widest mb-1">Network Overhead</p>
                            <h3 id="revenue-gas-summary" class="text-2xl font-bold text-white tracking-tight">$0.00</h3>
                            <div class="mt-4 flex items-center text-[8px] font-bold text-slate-400 uppercase tracking-tighter">
                                Average 0.8% Fee
                            </div>
                        </div>
                        <div class="glass-card p-6 rounded-3xl border border-white/5 bg-slate-900/50 relative overflow-hidden group">
                            <div class="absolute -right-4 -bottom-4 opacity-[0.03] group-hover:opacity-[0.08] transition-all duration-500 group-hover:scale-110">
                                <i class="fas fa-trophy text-6xl"></i>
                            </div>
                            <p class="text-[9px] font-bold text-slate-500 uppercase tracking-widest mb-1">Top Protocol</p>
                            <h3 class="text-2xl font-bold text-white tracking-tight">TRON (TRC20)</h3>
                            <div class="mt-4 flex items-center text-[8px] font-bold text-accent-blue uppercase tracking-tighter">
                                65% Share
                            </div>
                        </div>
                        <div class="glass-card p-6 rounded-3xl border border-white/5 bg-slate-900/50 relative overflow-hidden group">
                            <div class="absolute -right-4 -bottom-4 opacity-[0.03] group-hover:opacity-[0.08] transition-all duration-500 group-hover:scale-110">
                                <i class="fas fa-history text-6xl"></i>
                            </div>
                            <p class="text-[9px] font-bold text-slate-500 uppercase tracking-widest mb-1">Last Settlement</p>
                            <h3 id="last-settlement-time" class="text-2xl font-bold text-white tracking-tight">--</h3>
                            <div class="mt-4 flex items-center text-[8px] font-bold text-slate-400 uppercase tracking-tighter">
                                Real-time Feed
                            </div>
                        </div>
                    </div>
                    
                    <div class="glass-card rounded-[2.5rem] overflow-hidden border border-white/5">
                        <div class="overflow-x-auto">
                            <table class="w-full text-left border-separate border-spacing-y-0">
                                <thead>
                                    <tr class="bg-slate-900/50 text-slate-400 text-[10px] font-bold uppercase tracking-widest border-b border-white/5">
                                        <th class="px-8 py-6">Protocol</th>
                                        <th class="px-8 py-6">Asset</th>
                                        <th class="px-8 py-6">Gross Yield</th>
                                        <th class="px-8 py-6">Network Overhead</th>
                                        <th class="px-8 py-6">Net Profit</th>
                                        <th class="px-8 py-6 text-right">Settled At</th>
                                    </tr>
                                </thead>
                                <tbody id="revenues-table" class="divide-y divide-white/5">
                                    <!-- Revenues -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Blockchains Section -->
                <div id="blockchains-section" class="section hidden space-y-10">
                    <div class="flex flex-col md:flex-row md:items-center justify-between gap-6">
                        <div>
                            <h2 class="text-4xl font-extrabold text-white tracking-tight">Node Infrastructure</h2>
                            <p class="text-[10px] font-bold text-slate-500 uppercase tracking-[0.2em] mt-2">Real-time status and health of blockchain nodes</p>
                        </div>
                        <div class="flex flex-wrap items-center gap-3 bg-slate-900/50 p-1.5 rounded-2xl border border-white/5">
                            <button onclick="toggleAllBlockchains(true)" class="px-5 py-2.5 bg-accent-green/10 text-accent-green hover:bg-accent-green/20 rounded-xl font-bold text-[11px] uppercase tracking-wider transition-all flex items-center">
                                <i class="fas fa-play mr-2"></i> Ignite All
                            </button>
                            <button onclick="toggleAllBlockchains(false)" class="px-5 py-2.5 bg-accent-red/10 text-accent-red hover:bg-accent-red/20 rounded-xl font-bold text-[11px] uppercase tracking-wider transition-all flex items-center">
                                <i class="fas fa-power-off mr-2"></i> Emergency Stop
                            </button>
                        </div>
                    </div>

                    <!-- Infrastructure Overview -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="glass-card p-6 rounded-3xl border border-white/5 bg-slate-900/50 flex items-center justify-between">
                            <div>
                                <p class="text-[9px] font-bold text-slate-500 uppercase tracking-widest mb-1">Global Uptime</p>
                                <h3 class="text-2xl font-bold text-white tracking-tight">99.98%</h3>
                            </div>
                            <div class="w-12 h-12 rounded-2xl bg-accent-green/10 flex items-center justify-center text-accent-green">
                                <i class="fas fa-chart-line text-xl"></i>
                            </div>
                        </div>
                        <div class="glass-card p-6 rounded-3xl border border-white/5 bg-slate-900/50 flex items-center justify-between">
                            <div>
                                <p class="text-[9px] font-bold text-slate-500 uppercase tracking-widest mb-1">Average Latency</p>
                                <h3 class="text-2xl font-bold text-white tracking-tight">124ms</h3>
                            </div>
                            <div class="w-12 h-12 rounded-2xl bg-accent-blue/10 flex items-center justify-center text-accent-blue">
                                <i class="fas fa-bolt text-xl"></i>
                            </div>
                        </div>
                        <div class="glass-card p-6 rounded-3xl border border-white/5 bg-slate-900/50 flex items-center justify-between">
                            <div>
                                <p class="text-[9px] font-bold text-slate-500 uppercase tracking-widest mb-1">Total Requests (24h)</p>
                                <h3 class="text-2xl font-bold text-white tracking-tight">1.2M</h3>
                            </div>
                            <div class="w-12 h-12 rounded-2xl bg-accent-purple/10 flex items-center justify-center text-accent-purple">
                                <i class="fas fa-microchip text-xl"></i>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="blockchains-grid">
                        <!-- Blockchain cards -->
                    </div>
                </div>

                <!-- Status Section -->
                <div id="status-section" class="section hidden space-y-10">
                    <div class="flex flex-col md:flex-row md:items-center justify-between gap-6">
                        <div>
                            <h2 class="text-4xl font-extrabold text-white tracking-tight">System Integrity</h2>
                            <p class="text-[10px] font-bold text-slate-500 uppercase tracking-[0.2em] mt-2">Blockchain synchronization & Distributed ledger health</p>
                        </div>
                        <div class="flex items-center space-x-4">
                            <div class="flex items-center space-x-2 px-5 py-2.5 bg-accent-green/10 text-accent-green rounded-xl border border-accent-green/20">
                                <span class="w-2 h-2 bg-accent-green rounded-full animate-pulse shadow-[0_0_10px_rgba(16,185,129,0.5)]"></span>
                                <span class="text-[10px] font-bold uppercase tracking-widest">Core Synchronized</span>
                            </div>
                        </div>
                    </div>

                    <div id="sync-status-container" class="grid grid-cols-1 gap-10">
                        <!-- Sync status cards will be injected here -->
                    </div>
                </div>

                <!-- Settings Section -->
                <div id="settings-section" class="section hidden space-y-10">
                    <div class="flex flex-col md:flex-row md:items-center justify-between gap-6">
                        <div>
                            <h2 class="text-4xl font-extrabold text-white tracking-tight">System Configuration</h2>
                            <p class="text-[10px] font-bold text-slate-500 uppercase tracking-[0.2em] mt-2">Core operational parameters & Security protocols</p>
                        </div>
                        <div class="flex items-center space-x-3 bg-slate-900/50 p-1.5 rounded-2xl border border-white/5">
                            <div class="px-5 py-2.5 text-accent-orange bg-accent-orange/10 rounded-xl font-bold text-[11px] uppercase tracking-wider flex items-center">
                                <i class="fas fa-shield-alt mr-2"></i> Level 4 Access
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 xl:grid-cols-12 gap-10">
                        <div class="xl:col-span-8 space-y-8" id="settings-list">
                            <!-- Settings -->
                        </div>
                        <div class="xl:col-span-4 space-y-8">
                            <div class="glass-card p-8 rounded-[2.5rem] border border-white/5 bg-slate-900/50">
                                <h3 class="text-xl font-bold text-white mb-8 tracking-tight">Security Context</h3>
                                <div class="space-y-6">
                                    <div class="flex items-center justify-between p-6 bg-slate-950/50 rounded-2xl border border-white/5 transition-all hover:border-white/10 group">
                                        <div class="flex items-center">
                                            <div class="w-14 h-14 rounded-2xl bg-accent-green/10 flex items-center justify-center text-accent-green mr-5 group-hover:scale-110 transition-transform shadow-inner">
                                                <i class="fas fa-shield-alt text-2xl"></i>
                                            </div>
                                            <div class="flex flex-col">
                                                <span class="text-sm font-bold text-white">Encryption</span>
                                                <span class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mt-1">AES-256 Active</span>
                                            </div>
                                        </div>
                                        <span class="w-3 h-3 bg-accent-green rounded-full shadow-[0_0_10px_rgba(16,185,129,0.5)]"></span>
                                    </div>
                                    <div class="flex items-center justify-between p-6 bg-slate-950/50 rounded-2xl border border-white/5 transition-all hover:border-white/10 group">
                                        <div class="flex items-center">
                                            <div class="w-14 h-14 rounded-2xl bg-accent-blue/10 flex items-center justify-center text-accent-blue mr-5 group-hover:scale-110 transition-transform shadow-inner">
                                                <i class="fas fa-user-lock text-2xl"></i>
                                            </div>
                                            <div class="flex flex-col">
                                                <span class="text-sm font-bold text-white">Multi-sig</span>
                                                <span class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mt-1">Required</span>
                                            </div>
                                        </div>
                                        <div class="w-12 h-6 bg-accent-blue/20 rounded-full relative p-1 cursor-pointer">
                                            <div class="absolute right-1 top-1 w-4 h-4 bg-accent-blue rounded-full"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-8 p-6 bg-slate-950/30 rounded-2xl border border-white/5">
                                    <p class="text-[11px] text-slate-400 font-medium leading-relaxed italic">
                                        "All configuration changes are immutable and require dual-authorization for threshold adjustments."
                                    </p>
                                </div>
                                <button class="w-full mt-10 py-4 bg-slate-800/50 hover:bg-slate-800 text-[11px] font-bold text-white rounded-2xl transition-all border border-white/5 uppercase tracking-[0.2em]">
                                    Audit Trail
                                </button>
                            </div>

                            <div class="glass-card p-8 rounded-[2.5rem] border border-white/5 bg-slate-900/50">
                                <h3 class="text-xl font-bold text-white mb-6 tracking-tight">Maintenance</h3>
                                <p class="text-xs text-slate-500 leading-relaxed mb-8">System-wide maintenance will restart all background synchronizers. Use with caution during high volume periods.</p>
                                <button class="w-full py-4 bg-accent-red/10 hover:bg-accent-red/20 text-[11px] font-bold text-accent-red rounded-2xl transition-all border border-accent-red/20 uppercase tracking-[0.2em]">
                                    Restart Core Engine
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script>
        // API Configuration
        const API_URL = '/api/dashboard';
        let revenueChart;

        // Navigation
        function showSection(sectionId) {
            const sections = document.querySelectorAll('.section');
            sections.forEach(s => {
                s.classList.add('hidden');
                s.classList.remove('section-transition', 'opacity-100');
                s.classList.add('opacity-0');
            });

            const targetSection = document.getElementById(`${sectionId}-section`);
            if (targetSection) {
                targetSection.classList.remove('hidden');
                setTimeout(() => {
                    targetSection.classList.add('section-transition', 'opacity-100');
                    targetSection.classList.remove('opacity-0');
                }, 50);
            }

            document.querySelectorAll('.sidebar-link').forEach(l => {
                l.classList.remove('active', 'text-accent-blue', 'bg-slate-800/50');
                l.classList.add('text-slate-400');
            });
            
            const activeLink = document.getElementById(`nav-${sectionId}`);
            if (activeLink) {
                activeLink.classList.remove('text-slate-400');
                activeLink.classList.add('active');
            }

            const titleMap = {
                'dashboard': { title: 'Analytics Overview', subtitle: 'Real-time Network Intelligence' },
                'transactions': { title: 'Transaction Ledger', subtitle: 'On-chain Activity Stream' },
                'wallets': { title: 'Asset Inventory', subtitle: 'Secure Wallet Management' },
                'revenues': { title: 'Revenue Analysis', subtitle: 'Financial Performance Metrics' },
                'blockchains': { title: 'Node Infrastructure', subtitle: 'Multi-chain Connectivity' },
                'status': { title: 'System Status', subtitle: 'Service Health & Monitoring' },
                'settings': { title: 'Configuration Console', subtitle: 'System & Security Settings' }
            };
            
            const config = titleMap[sectionId] || { title: 'Analytics', subtitle: 'Blockchain Suite' };
            document.getElementById('section-title').textContent = config.title;
            document.getElementById('section-subtitle').textContent = config.subtitle;

            if (sectionId === 'dashboard') fetchData();
            if (sectionId === 'wallets') fetchWallets();
            if (sectionId === 'transactions') fetchAllTransactions();
            if (sectionId === 'revenues') fetchRevenues();
            if (sectionId === 'blockchains') fetchBlockchains();
            if (sectionId === 'status') fetchSyncStatus();
            if (sectionId === 'settings') fetchSettings();
        }

        function toggleTheme() {
            const icon = document.querySelector('button onclick="toggleTheme()" i') || document.querySelector('header button:last-child i');
            if (icon.classList.contains('fa-moon')) {
                icon.classList.remove('fa-moon');
                icon.classList.add('fa-sun');
                // Could implement light mode here, but user asked for "dark mode view" as professional
            } else {
                icon.classList.remove('fa-sun');
                icon.classList.add('fa-moon');
            }
        }

        function getUserId() {
            return document.getElementById('global-user-filter').value;
        }

        function handleUserFilterChange() {
            const activeSection = Array.from(document.querySelectorAll('.section')).find(s => !s.classList.contains('hidden')).id.replace('-section', '');
            showSection(activeSection);
        }

        async function fetchUsers() {
            try {
                const res = await fetch(`${API_URL}/users`).then(r => r.json());
                const select = document.getElementById('global-user-filter');
                const users = res.data || [];
                users.forEach(user => {
                    const option = document.createElement('option');
                    option.value = user.id;
                    option.textContent = user.identifier;
                    select.appendChild(option);
                });
            } catch (error) {
                console.error('Failed to fetch users:', error);
            }
        }

        async function fetchData() {
            try {
                const userId = getUserId();
                const [statsRes, txRes, bcRes, chartRes] = await Promise.all([
                    fetch(`${API_URL}/stats?userId=${userId}`).then(r => r.json()),
                    fetch(`${API_URL}/recent-transactions?userId=${userId}`).then(r => r.json()),
                    fetch(`${API_URL}/blockchains?userId=${userId}`).then(r => r.json()),
                    fetch(`${API_URL}/revenue-chart?userId=${userId}`).then(r => r.json())
                ]);

                const stats = statsRes.data || {};
                document.getElementById('total-transactions').textContent = (stats.totalTransactions || 0).toLocaleString();
                document.getElementById('pending-withdrawals').textContent = (stats.pendingWithdrawals || 0).toLocaleString();
                document.getElementById('total-revenue').textContent = '$' + (stats.totalRevenue || 0).toLocaleString(undefined, {minimumFractionDigits: 2});
                document.getElementById('total-user-balance').textContent = '$' + (stats.totalUserBalance || 0).toLocaleString(undefined, {minimumFractionDigits: 2});
                document.getElementById('total-network-balance').textContent = '$' + (stats.totalNetworkBalance || 0).toLocaleString(undefined, {minimumFractionDigits: 2});
                document.getElementById('active-blockchains').textContent = stats.activeBlockchains || 0;

                renderTransactions(txRes.data || [], 'transactions-table-recent');

                const bcList = document.getElementById('blockchain-list');
                bcList.innerHTML = (bcRes.data || []).map(bc => `
                    <div class="flex items-center justify-between p-5 bg-slate-900/50 rounded-2xl border border-white/5 group hover:border-white/10 transition-all">
                        <div class="flex items-center">
                            <div class="w-10 h-10 rounded-xl bg-slate-800 flex items-center justify-center text-slate-400 mr-4 group-hover:text-accent-blue transition-colors">
                                <i class="fas fa-link text-xs"></i>
                            </div>
                            <div>
                                <p class="text-sm font-bold text-white">${bc.name}</p>
                                <p class="text-[9px] font-bold text-slate-500 uppercase tracking-widest mt-0.5">${bc.transactionCount.toLocaleString()} Operations</p>
                            </div>
                        </div>
                        <div class="flex flex-col items-end">
                            <span class="w-2 h-2 ${bc.isActive ? 'bg-accent-green shadow-[0_0_10px_rgba(16,185,129,0.5)]' : 'bg-accent-red'} rounded-full"></span>
                            <span class="text-[8px] font-bold text-slate-500 uppercase mt-2 tracking-widest">${bc.isActive ? 'Active' : 'Halted'}</span>
                        </div>
                    </div>
                `).join('');

                updateChart(chartRes.data || []);
            } catch (error) {
                console.error('Core Data Fetch Failure:', error);
            }
        }

        function renderTransactions(transactions, tableId) {
            const tbody = document.getElementById(tableId);
            tbody.innerHTML = transactions.map(tx => `
                <tr class="hover:bg-slate-800/30 transition-colors group">
                    <td class="px-8 py-6">
                        <div class="flex items-center">
                            <div class="w-8 h-8 rounded-lg bg-slate-800 flex items-center justify-center text-slate-500 mr-4 group-hover:bg-slate-700 transition-colors">
                                <i class="fas fa-hashtag text-[10px]"></i>
                            </div>
                            <span class="font-mono text-xs text-accent-blue hover:underline cursor-pointer truncate max-w-[120px] font-bold tracking-wider" title="${tx.transactionHash}">${tx.transactionHash || 'In Progress...'}</span>
                        </div>
                    </td>
                    <td class="px-8 py-6">
                        <span class="px-3 py-1 bg-slate-800 text-slate-400 rounded-lg text-[10px] font-bold uppercase tracking-widest border border-white/5 group-hover:text-white transition-colors">${tx.blockchain?.name || 'Unknown'}</span>
                    </td>
                    <td class="px-8 py-6">
                        <span class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">${tx.type}</span>
                    </td>
                    <td class="px-8 py-6">
                        <div class="flex flex-col">
                            <span class="text-sm font-bold text-white">${(tx.value || 0).toFixed(4)} <span class="text-[10px] text-slate-500 font-bold ml-1">${tx.currency?.symbol}</span></span>
                        </div>
                    </td>
                    <td class="px-8 py-6 text-center">
                        <span class="px-3 py-1 rounded-lg text-[10px] font-bold uppercase tracking-widest border ${getStatusStyle(tx.status)}">
                            ${tx.status}
                        </span>
                    </td>
                    <td class="px-8 py-6 text-right">
                        <span class="text-xs text-slate-500 font-medium">${new Date(tx.createdAt).toLocaleString()}</span>
                    </td>
                </tr>
            `).join('');
        }

        function getStatusStyle(status) {
            switch(status) {
                case 'SUCCESS': return 'bg-accent-green/10 text-accent-green border border-accent-green/20';
                case 'PENDING': return 'bg-accent-orange/10 text-accent-orange border border-accent-orange/20';
                case 'FAILED': return 'bg-accent-red/10 text-accent-red border border-accent-red/20';
                default: return 'bg-slate-700/50 text-slate-400';
            }
        }

        async function fetchWallets() {
            try {
                const userId = getUserId();
                const res = await fetch(`${API_URL}/wallets?userId=${userId}`).then(r => r.json());
                const wallets = res.data || [];
                const tbody = document.getElementById('wallets-table');
                
                let totalBalance = 0;
                let activeAssets = new Set();

                tbody.innerHTML = wallets.map(w => {
                    // Calculate total balance for summary
                    (w.balances || []).forEach(b => {
                        totalBalance += parseFloat(b.networkBalance || 0);
                        if (b.currency) activeAssets.add(b.currency);
                    });

                    return `
                    <tr class="hover:bg-slate-800/30 transition-colors group">
                        <td class="px-8 py-6">
                            <div class="flex items-center">
                                <div class="w-10 h-10 rounded-xl bg-slate-800 flex items-center justify-center text-accent-blue mr-4 group-hover:bg-slate-700 transition-colors">
                                    <i class="fas fa-shield-alt"></i>
                                </div>
                                <span class="font-mono text-xs text-slate-300 select-all truncate max-w-[150px]" title="${w.address}">${w.address}</span>
                            </div>
                        </td>
                        <td class="px-8 py-6">
                            <div class="flex flex-col">
                                <span class="text-sm font-bold text-white">${w.user || 'N/A'}</span>
                                <span class="text-[10px] text-slate-500 font-bold uppercase tracking-tighter">Verified Identity</span>
                            </div>
                        </td>
                        <td class="px-8 py-6">
                            <span class="px-3 py-1 bg-dark-950 text-slate-400 rounded-lg text-[10px] font-bold uppercase border border-slate-800 group-hover:text-white transition-colors">${w.blockchain || 'N/A'}</span>
                        </td>
                        <td class="px-8 py-6">
                            <div class="grid grid-cols-2 gap-2 max-w-[300px]">
                                ${(w.balances || []).map(b => `
                                    <div class="bg-slate-800/50 p-2 rounded-xl border border-slate-700/50 group-hover:border-slate-600 transition-colors">
                                        <div class="flex justify-between items-center mb-1">
                                            <span class="text-[10px] font-bold text-slate-500">${b.currency}</span>
                                            <span class="text-[8px] px-1 bg-accent-blue/20 text-accent-blue rounded">On-chain</span>
                                        </div>
                                        <p class="text-xs font-bold text-white">${(parseFloat(b.networkBalance || 0)).toFixed(4)}</p>
                                    </div>
                                `).join('')}
                            </div>
                        </td>
                        <td class="px-8 py-6">
                            <div class="flex items-center text-accent-green font-bold text-[10px] uppercase tracking-widest">
                                <span class="w-1.5 h-1.5 bg-accent-green rounded-full mr-2 shadow-[0_0_8px_rgba(16,185,129,0.4)]"></span>
                                Operational
                            </div>
                        </td>
                        <td class="px-8 py-6 text-right text-xs text-slate-500 font-medium">
                            ${new Date(w.createdAt).toLocaleDateString()}
                        </td>
                    </tr>
                `}).join('');

                document.getElementById('wallet-count-summary').textContent = wallets.length;
                document.getElementById('wallet-assets-summary').textContent = activeAssets.size;
                document.getElementById('wallet-balance-summary').textContent = '$' + totalBalance.toLocaleString(undefined, {minimumFractionDigits: 2});
            } catch (error) {
                console.error('Failed to fetch wallets:', error);
            }
        }

        async function fetchAllTransactions() {
            try {
                const userId = getUserId();
                const res = await fetch(`${API_URL}/recent-transactions?limit=100&userId=${userId}`).then(r => r.json());
                const transactions = res.data || [];
                renderTransactions(transactions, 'transactions-table-full');

                let totalVolume = 0;
                let pendingCount = 0;
                let successCount = 0;
                
                transactions.forEach(tx => {
                    totalVolume += parseFloat(tx.value || 0);
                    if (tx.status === 'PENDING') pendingCount++;
                    if (tx.status === 'SUCCESS') successCount++;
                });

                const successRate = transactions.length > 0 ? (successCount / transactions.length * 100).toFixed(1) : 100;

                document.getElementById('tx-total-summary').textContent = transactions.length;
                document.getElementById('tx-success-summary').textContent = successRate + '%';
                document.getElementById('tx-volume-summary').textContent = '$' + totalVolume.toLocaleString(undefined, {minimumFractionDigits: 2});
                document.getElementById('tx-pending-summary').textContent = pendingCount;
            } catch (error) {
                console.error('Failed to fetch transactions:', error);
            }
        }

        async function fetchRevenues() {
            try {
                const userId = getUserId();
                const res = await fetch(`${API_URL}/revenues?userId=${userId}`).then(r => r.json());
                const revenues = res.data || [];
                const tbody = document.getElementById('revenues-table');
                
                let totalNet = 0;
                let totalFee = 0;
                let lastSettlement = null;

                tbody.innerHTML = revenues.map(rev => {
                    const amount = parseFloat(rev.revenue || 0);
                    const fee = parseFloat(rev.networkFee || rev.fee || 0);
                    const net = amount; // Based on the user rules: revenue is the net profit already calculated or we show gross vs fee
                    
                    totalNet += amount;
                    totalFee += fee;
                    if (!lastSettlement || new Date(rev.createdAt) > new Date(lastSettlement)) {
                        lastSettlement = rev.createdAt;
                    }
                    
                    return `
                        <tr class="hover:bg-slate-800/30 transition-colors group">
                            <td class="px-8 py-6">
                                <div class="flex items-center">
                                    <div class="w-8 h-8 rounded-lg bg-slate-800 flex items-center justify-center text-slate-400 mr-3 group-hover:text-accent-blue transition-colors">
                                        <i class="fas fa-link text-[10px]"></i>
                                    </div>
                                    <span class="font-bold text-white text-sm">${rev.blockchain?.name || 'N/A'}</span>
                                </div>
                            </td>
                            <td class="px-8 py-6">
                                <span class="px-3 py-1 bg-accent-purple/10 text-accent-purple rounded-lg text-[10px] font-bold border border-accent-purple/20 uppercase tracking-widest">${rev.currency?.symbol || 'N/A'}</span>
                            </td>
                            <td class="px-8 py-6 text-slate-300 font-medium">${(amount + fee).toFixed(4)}</td>
                            <td class="px-8 py-6 text-accent-red/70 font-medium">-${fee.toFixed(4)}</td>
                            <td class="px-8 py-6">
                                <span class="text-sm font-bold text-accent-green">+$${amount.toFixed(2)}</span>
                            </td>
                            <td class="px-8 py-6 text-right text-xs text-slate-500 font-medium">
                                ${new Date(rev.createdAt).toLocaleString()}
                            </td>
                        </tr>
                    `;
                }).join('');
                
                document.getElementById('revenue-total-summary').textContent = '$' + totalNet.toLocaleString(undefined, {minimumFractionDigits: 2});
                document.getElementById('revenue-gas-summary').textContent = '$' + totalFee.toLocaleString(undefined, {minimumFractionDigits: 2});
                document.getElementById('last-settlement-time').textContent = lastSettlement ? new Date(lastSettlement).toLocaleTimeString() : '--';
            } catch (error) {
                console.error('Failed to fetch revenues:', error);
            }
        }

        async function fetchSyncStatus() {
            try {
                const res = await fetch(`${API_URL}/sync-status`).then(r => r.json());
                const container = document.getElementById('sync-status-container');
                const statusData = res.data || [];

                container.innerHTML = statusData.map(status => {
                    const healthClass = status.isHealthy ? 'text-accent-green' : 'text-accent-red';
                    const healthIcon = status.isHealthy ? 'fa-check-circle' : 'fa-exclamation-triangle';
                    
                    // Create a visual map of the last 50 blocks
                    const historyMap = new Set((status.history || []).map(h => h.number));
                    let blocksHtml = '';
                    const latest = status.latestBlock || status.lastSyncBlock || 0;
                    
                    for (let i = latest; i > latest - 50; i--) {
                        if (i <= 0) break;
                        const hasBlock = historyMap.has(i);
                        const blockClass = hasBlock ? 'bg-accent-green' : 'bg-accent-red animate-pulse';
                        const tooltip = `Block #${i} ${hasBlock ? '(Synced)' : '(Missing)'}`;
                        blocksHtml += `<div class="w-3 h-8 rounded-sm ${blockClass}" title="${tooltip}"></div>`;
                    }

                    return `
                        <div class="glass-card p-8 rounded-[2.5rem] flex flex-col space-y-6">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-4">
                                    <div class="w-12 h-12 rounded-2xl bg-slate-800 flex items-center justify-center text-accent-blue">
                                        <i class="fas fa-network-wired text-xl"></i>
                                    </div>
                                    <div>
                                        <h3 class="text-xl font-bold text-white">${status.blockchain}</h3>
                                        <p class="text-xs text-slate-500 font-medium">Last Sync: ${status.lastSync ? new Date(status.lastSync).toLocaleString() : 'Never'}</p>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-2 ${healthClass} font-bold text-sm uppercase tracking-widest">
                                    <i class="fas ${healthIcon}"></i>
                                    <span>${status.isHealthy ? 'Synchronized' : 'Gaps Detected'}</span>
                                </div>
                            </div>

                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                <div class="bg-slate-800/50 p-6 rounded-2xl border border-slate-700">
                                    <p class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-2">Network Tip</p>
                                    <p class="text-2xl font-bold text-white">${(latest).toLocaleString()}</p>
                                </div>
                                <div class="bg-slate-800/50 p-6 rounded-2xl border border-slate-700">
                                    <p class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-2">Sequence Integrity</p>
                                    <p class="text-2xl font-bold text-white">${status.isHealthy ? '100%' : 'Degraded'}</p>
                                </div>
                                <div class="bg-slate-800/50 p-6 rounded-2xl border border-slate-700">
                                    <p class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-2">Detected Gaps</p>
                                    <p class="text-2xl font-bold ${(status.gaps || []).length > 0 ? 'text-accent-red' : 'text-white'}">${(status.gaps || []).length}</p>
                                </div>
                            </div>

                            <div class="space-y-3">
                                <p class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Block Sequence Map (Last 50 Blocks)</p>
                                <div class="flex flex-wrap gap-1 p-4 bg-dark-950/50 rounded-2xl border border-slate-800">
                                    ${blocksHtml}
                                </div>
                                <p class="text-[10px] text-slate-500 font-medium italic">Red blocks indicate missing data in the sequence, which the backfill service will automatically attempt to recover.</p>
                            </div>
                        </div>
                    `;
                }).join('');
            } catch (error) {
                console.error('Failed to fetch sync status:', error);
            }
        }

        async function fetchBlockchains() {
            try {
                const res = await fetch(`${API_URL}/blockchains`).then(r => r.json());
                const grid = document.getElementById('blockchains-grid');
                grid.innerHTML = (res.data || []).map(bc => `
                    <div class="glass-card p-8 rounded-[2.5rem] relative group hover:border-white/10 transition-all duration-500 overflow-hidden bg-slate-900/30">
                        <div class="absolute -right-8 -top-8 w-40 h-40 bg-accent-blue/5 rounded-full blur-3xl group-hover:bg-accent-blue/10 transition-all duration-500"></div>
                        <div class="flex items-center justify-between mb-8 relative z-10">
                            <div class="w-16 h-16 rounded-2xl bg-slate-800/80 border border-white/5 flex items-center justify-center text-2xl text-slate-400 group-hover:text-accent-blue transition-all duration-500 shadow-inner">
                                <i class="fas fa-cubes"></i>
                            </div>
                            <div class="flex flex-col items-end">
                                <div class="flex items-center space-x-2 px-3 py-1 bg-slate-900/50 rounded-full border border-white/5">
                                    <span class="w-2 h-2 ${bc.isActive ? 'bg-accent-green animate-pulse shadow-[0_0_8px_rgba(16,185,129,0.5)]' : 'bg-accent-red'} rounded-full"></span>
                                    <span class="text-[9px] font-bold text-slate-400 uppercase tracking-widest">${bc.isActive ? 'Active' : 'Halted'}</span>
                                </div>
                            </div>
                        </div>
                        <div class="relative z-10">
                            <h3 class="text-2xl font-bold text-white mb-1 tracking-tight">${bc.name}</h3>
                            <p class="text-[10px] font-bold text-slate-500 uppercase tracking-[0.2em] mb-8">${bc.bpm} Blocks / min</p>
                            
                            <div class="grid grid-cols-2 gap-4 mb-8">
                                <div class="bg-slate-950/50 p-5 rounded-2xl border border-white/5">
                                    <p class="text-[8px] font-bold text-slate-500 uppercase tracking-widest mb-1.5">Network Height</p>
                                    <p class="text-sm font-bold text-white tracking-tight">${(bc.transactionCount || 0).toLocaleString()}</p>
                                </div>
                                <div class="bg-slate-950/50 p-5 rounded-2xl border border-white/5">
                                    <p class="text-[8px] font-bold text-slate-500 uppercase tracking-widest mb-1.5">Latency</p>
                                    <p class="text-sm font-bold text-accent-green tracking-tight">Optimized</p>
                                </div>
                            </div>

                            <button onclick="toggleBlockchain('${bc.name}', ${!bc.isActive})" class="w-full py-4 rounded-2xl text-[10px] font-bold uppercase tracking-[0.2em] transition-all ${bc.isActive ? 'bg-slate-800/50 text-slate-400 hover:bg-accent-red/10 hover:text-accent-red hover:border-accent-red/20 border border-white/5' : 'bg-accent-green/10 text-accent-green border border-accent-green/20 hover:bg-accent-green/20 shadow-lg shadow-accent-green/5'}">
                                ${bc.isActive ? 'Shutdown Node' : 'Launch Node'}
                            </button>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                console.error('Failed to fetch blockchains:', error);
            }
        }

        async function fetchSettings() {
            try {
                const res = await fetch(`${API_URL}/settings`).then(r => r.json());
                const container = document.getElementById('settings-list');
                container.innerHTML = (res.data || []).map(s => `
                    <div class="glass-card p-8 rounded-[2.5rem] flex flex-col md:flex-row items-center justify-between group hover:border-white/10 transition-all bg-slate-900/30 border border-white/5">
                        <div class="flex-1 md:mr-10 mb-6 md:mb-0">
                            <div class="flex items-center mb-3">
                                <div class="w-10 h-10 rounded-xl bg-slate-800/80 border border-white/5 flex items-center justify-center text-slate-400 mr-4 group-hover:text-accent-orange transition-colors">
                                    <i class="fas fa-cog text-sm"></i>
                                </div>
                                <h4 class="text-base font-bold text-white uppercase tracking-wider">${s.key.replace(/_/g, ' ')}</h4>
                            </div>
                            <p class="text-xs text-slate-500 font-medium leading-relaxed max-w-xl">Configure the threshold and operational parameters for the system's core synchronization engine.</p>
                        </div>
                        <div class="flex items-center space-x-4 w-full md:w-auto">
                            <input id="setting-${s.id}" type="text" value="${s.value}" class="flex-1 md:w-64 px-6 py-4 bg-slate-950 border border-white/10 rounded-2xl text-xs font-mono text-accent-blue focus:outline-none focus:border-accent-blue transition-all shadow-inner">
                            <button onclick="updateSetting(${s.id}, '${s.key}')" class="w-14 h-14 flex items-center justify-center rounded-2xl bg-accent-blue text-white shadow-lg shadow-blue-500/20 hover:scale-105 active:scale-95 transition-all">
                                <i class="fas fa-save text-lg"></i>
                            </button>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                console.error('Failed to fetch settings:', error);
            }
        }

        async function updateSetting(id, key) {
            const value = document.getElementById(`setting-${id}`).value;
            try {
                const res = await fetch(`${API_URL}/settings`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ key, value })
                }).then(r => r.json());
                
                if (res.status === 200) alert('Configuration updated successfully.');
                else alert('Update failed: ' + res.message);
            } catch (err) {
                alert('System Error: ' + err.message);
            }
        }

        async function toggleBlockchain(symbol, isActive) {
            try {
                await fetch('/api/blockchain/toggle', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ symbol, is_active: isActive })
                });
                fetchBlockchains();
                fetchData();
            } catch (error) {
                console.error('Toggle failed:', error);
            }
        }

        async function toggleAllBlockchains(isActive) {
            try {
                await fetch('/api/blockchain/toggle-all', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ is_active: isActive })
                });
                fetchBlockchains();
                fetchData();
            } catch (error) {
                console.error('Toggle all failed:', error);
            }
        }

        function updateChart(chartData) {
            const ctx = document.getElementById('revenueChart').getContext('2d');
            const labels = chartData.map(d => d.date);
            const values = chartData.map(d => d.amount);

            if (revenueChart) revenueChart.destroy();

            const gradient = ctx.createLinearGradient(0, 0, 0, 400);
            gradient.addColorStop(0, 'rgba(59, 130, 246, 0.2)');
            gradient.addColorStop(1, 'rgba(59, 130, 246, 0)');

            revenueChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels,
                    datasets: [{
                        label: 'Net Revenue ($)',
                        data: values,
                        borderColor: '#3b82f6',
                        borderWidth: 4,
                        backgroundColor: gradient,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#3b82f6',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2,
                        pointRadius: 6,
                        pointHoverRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: '#1e293b',
                            titleFont: { family: 'Inter', weight: 'bold' },
                            bodyFont: { family: 'Inter' },
                            padding: 15,
                            cornerRadius: 12,
                            displayColors: false
                        }
                    },
                    scales: {
                        y: {
                            grid: { color: 'rgba(255, 255, 255, 0.05)', drawBorder: false },
                            ticks: { color: '#64748b', font: { family: 'Inter', size: 10, weight: 'bold' } }
                        },
                        x: {
                            grid: { display: false },
                            ticks: { color: '#64748b', font: { family: 'Inter', size: 10, weight: 'bold' } }
                        }
                    }
                }
            });
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            fetchUsers();
            showSection('dashboard');
            // Auto-refresh every 30s
            setInterval(() => {
                const activeSection = Array.from(document.querySelectorAll('.section')).find(s => !s.classList.contains('hidden'))?.id.replace('-section', '');
                if (activeSection === 'dashboard') fetchData();
            }, 30000);
        });
    </script>
</body>
</html>
